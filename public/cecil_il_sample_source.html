<!DOCTYPE html  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>test.cs</title>
<meta name="GENERATOR" content="SciTE - www.Scintilla.org" />
<style type="text/css">
.S0 {
	color: #808080;
	background: #FFFFFF;
}
.S2 {
	font-family: 'Courier New';
	color: #007F00;
	background: #FFFFFF;
	font-size: 10pt;
}
.S4 {
	color: #007F7F;
	background: #FFFFFF;
}
.S5 {
	font-weight: bold;
	color: #00007F;
	background: #FFFFFF;
}
.S6 {
	color: #7F007F;
	background: #FFFFFF;
}
.S10 {
	font-weight: bold;
	color: #000000;
	background: #FFFFFF;
}
span {
	font-family: 'Courier New';
	color: #000000;
	background: #FFFFFF;
	font-size: 10pt;
}
</style>
</head>
<body bgcolor="#FFFFFF">
<span><span class="S2">// mcs -r:Mono.Cecil.dll test.cs</span><br />
<span class="S5">using</span><span class="S0"> </span>System<span class="S10">;</span><br />
<br />
<span class="S5">using</span><span class="S0"> </span>Mono<span class="S10">.</span>Cecil<span class="S10">;</span><br />
<span class="S5">using</span><span class="S0"> </span>Mono<span class="S10">.</span>Cecil<span class="S10">.</span>Cil<span class="S10">;</span><br />
<br />
<span class="S5">public</span><span class="S0"> </span><span class="S5">class</span><span class="S0"> </span>Test<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">static</span><span class="S0"> </span><span class="S5">void</span><span class="S0"> </span>Main<span class="S0"> </span><span class="S10">(</span><span class="S5">string</span><span class="S0"> </span><span class="S10">[]</span><span class="S0"> </span>args<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>IAssemblyDefinition<span class="S0"> </span>asm<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>AssemblyFactory<span class="S10">.</span>GetAssembly<span class="S0"> </span><span class="S10">(</span><span class="S6">"test.exe"</span><span class="S10">,</span><span class="S0"> </span>LoadingType<span class="S10">.</span>Lazy<span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ITypeDefinition<span class="S0"> </span>test<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>asm<span class="S10">.</span>MainModule<span class="S10">.</span>Types<span class="S0"> </span><span class="S10">[</span><span class="S6">"Test"</span><span class="S10">];</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">foreach</span><span class="S0"> </span><span class="S10">(</span>IMethodDefinition<span class="S0"> </span>meth<span class="S0"> </span><span class="S5">in</span><span class="S0"> </span>test<span class="S10">.</span>Methods<span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span>meth<span class="S10">.</span>ToString<span class="S0"> </span><span class="S10">());</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span><span class="S6">"{"</span><span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span><span class="S6">" &nbsp;// code size : {0}"</span><span class="S10">,</span><span class="S0"> </span>meth<span class="S10">.</span>Body<span class="S10">.</span>CodeSize<span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span><span class="S6">" &nbsp;.maxstack {0}"</span><span class="S10">,</span><span class="S0"> </span>meth<span class="S10">.</span>Body<span class="S10">.</span>MaxStack<span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>Write<span class="S0"> </span><span class="S10">(</span><span class="S6">" &nbsp;.locals ("</span><span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">for</span><span class="S0"> </span><span class="S10">(</span><span class="S5">int</span><span class="S0"> </span>i<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S4">0</span><span class="S10">;</span><span class="S0"> </span>i<span class="S0"> </span><span class="S10">&lt;</span><span class="S0"> </span>meth<span class="S10">.</span>Body<span class="S10">.</span>Variables<span class="S10">.</span>Count<span class="S10">;</span><span class="S0"> </span>i<span class="S10">++)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S10">(</span>i<span class="S0"> </span><span class="S10">&gt;</span><span class="S0"> </span><span class="S4">0</span><span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>Write<span class="S0"> </span><span class="S10">(</span><span class="S6">", "</span><span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>IVariableDefinition<span class="S0"> </span>var<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>meth<span class="S10">.</span>Body<span class="S10">.</span>Variables<span class="S0"> </span><span class="S10">[</span>i<span class="S10">];</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>Write<span class="S0"> </span><span class="S10">(</span><span class="S5">string</span><span class="S10">.</span>Concat<span class="S10">(</span>var<span class="S10">.</span>Variable<span class="S10">.</span>FullName<span class="S10">,</span><span class="S0"> </span><span class="S6">" "</span><span class="S10">,</span><span class="S0"> </span>var<span class="S10">.</span>Name<span class="S10">));</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span><span class="S6">")"</span><span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">foreach</span><span class="S0"> </span><span class="S10">(</span>IInstruction<span class="S0"> </span>instr<span class="S0"> </span><span class="S5">in</span><span class="S0"> </span>meth<span class="S10">.</span>Body<span class="S10">.</span>Instructions<span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>Write<span class="S0"> </span><span class="S10">(</span><span class="S6">" &nbsp;IL_{0}: {1} "</span><span class="S10">,</span><span class="S0"> </span>instr<span class="S10">.</span>Offset<span class="S10">.</span>ToString<span class="S0"> </span><span class="S10">(</span><span class="S6">"X4"</span><span class="S10">),</span><span class="S0"> </span>instr<span class="S10">.</span>OpCode<span class="S10">.</span>Name<span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">switch</span><span class="S0"> </span><span class="S10">(</span>instr<span class="S10">.</span>OpCode<span class="S10">.</span>OperandType<span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">case</span><span class="S0"> </span>OperandType<span class="S10">.</span>InlineNone<span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span><span class="S6">""</span><span class="S10">);</span><span class="S0"> </span><span class="S5">break</span><span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">case</span><span class="S0"> </span>OperandType<span class="S10">.</span>InlineSwitch<span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">int</span><span class="S0"> </span><span class="S10">[]</span><span class="S0"> </span>brchs<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>instr<span class="S10">.</span>Operand<span class="S0"> </span><span class="S5">as</span><span class="S0"> </span><span class="S5">int</span><span class="S0"> </span><span class="S10">[];</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">for</span><span class="S0"> </span><span class="S10">(</span><span class="S5">int</span><span class="S0"> </span>i<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S4">0</span><span class="S10">;</span><span class="S0"> </span>i<span class="S0"> </span><span class="S10">&lt;</span><span class="S0"> </span>brchs<span class="S10">.</span>Length<span class="S10">;</span><span class="S0"> </span>i<span class="S10">++)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S10">(</span>i<span class="S0"> </span><span class="S10">&gt;</span><span class="S0"> </span><span class="S4">0</span><span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>Write<span class="S0"> </span><span class="S10">(</span><span class="S6">", "</span><span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>Write<span class="S0"> </span><span class="S10">(</span><span class="S6">"IL_{0}"</span><span class="S10">,</span><span class="S0"> </span>brchs<span class="S0"> </span><span class="S10">[</span>i<span class="S10">].</span>ToString<span class="S0"> </span><span class="S10">(</span><span class="S6">"X4"</span><span class="S10">));</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span><span class="S6">""</span><span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">break</span><span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">case</span><span class="S0"> </span>OperandType<span class="S10">.</span>ShortInlineBrTarget<span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">case</span><span class="S0"> </span>OperandType<span class="S10">.</span>InlineBrTarget<span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span><span class="S6">"IL_{0}"</span><span class="S10">,</span><span class="S0"> </span><span class="S10">((</span><span class="S5">int</span><span class="S10">)</span>instr<span class="S10">.</span>Operand<span class="S10">).</span>ToString<span class="S0"> </span><span class="S10">(</span><span class="S6">"X4"</span><span class="S10">));</span><span class="S0"> </span><span class="S5">break</span><span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">case</span><span class="S0"> </span>OperandType<span class="S10">.</span>InlineString<span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span><span class="S6">"\"{0}\""</span><span class="S10">,</span><span class="S0"> </span>instr<span class="S10">.</span>Operand<span class="S10">);</span><span class="S0"> </span><span class="S5">break</span><span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">default</span><span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span>instr<span class="S10">.</span>Operand<span class="S10">);</span><span class="S0"> </span><span class="S5">break</span><span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span><span class="S6">"}"</span><span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Console<span class="S10">.</span>WriteLine<span class="S0"> </span><span class="S10">(</span><span class="S6">""</span><span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S10">}</span></span>
</body>
</html>
