<!DOCTYPE html  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>ILMergeTask.cs</title>
<meta name="GENERATOR" content="SciTE - www.Scintilla.org" />
<style type="text/css">
.S0 {
	color: #808080;
	background: #FFFFFF;
}
.S3 {
	font-family: 'Courier New';
	color: #3F703F;
	background: #FFFFFF;
	font-size: 10pt;
}
.S4 {
	color: #007F7F;
	background: #FFFFFF;
}
.S5 {
	font-weight: bold;
	color: #00007F;
	background: #FFFFFF;
}
.S6 {
	color: #7F007F;
	background: #FFFFFF;
}
.S10 {
	font-weight: bold;
	color: #000000;
	background: #FFFFFF;
}
.S18 {
	font-family: 'Courier New';
	color: #804020;
	background: #FFFFFF;
	font-size: 10pt;
}
span {
	font-family: 'Courier New';
	color: #000000;
	background: #FFFFFF;
	font-size: 10pt;
}
</style>
</head>
<body bgcolor="#FFFFFF">
<span><span class="S3">/**</span><br />
<span class="S3">&nbsp;* Copyright (c) 2004, Evain Jb (jb</span><span class="S18">@evain</span><span class="S3">.net)</span><br />
<span class="S3">&nbsp;* All rights reserved.</span><br />
<span class="S3">&nbsp;*</span><br />
<span class="S3">&nbsp;* Redistribution and use in source and binary forms, with or without</span><br />
<span class="S3">&nbsp;* modification, are permitted provided that the following conditions are met:</span><br />
<span class="S3">&nbsp;*</span><br />
<span class="S3">&nbsp;* &nbsp;&nbsp;&nbsp;&nbsp;- Redistributions of source code must retain the above copyright</span><br />
<span class="S3">&nbsp;* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notice, this list of conditions and the following disclaimer.</span><br />
<span class="S3">&nbsp;* &nbsp;&nbsp;&nbsp;&nbsp;- Redistributions in binary form must reproduce the above copyright</span><br />
<span class="S3">&nbsp;* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notice, this list of conditions and the following disclaimer in the</span><br />
<span class="S3">&nbsp;* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;documentation and/or other materials provided with the distribution.</span><br />
<span class="S3">&nbsp;* &nbsp;&nbsp;&nbsp;&nbsp;- Neither the name of Evain Jb nor the names of its contributors may</span><br />
<span class="S3">&nbsp;* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;be used to endorse or promote products derived from this software</span><br />
<span class="S3">&nbsp;* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;without specific prior written permission.</span><br />
<span class="S3">&nbsp;*</span><br />
<span class="S3">&nbsp;* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</span><br />
<span class="S3">&nbsp;* AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span><br />
<span class="S3">&nbsp;* IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span><br />
<span class="S3">&nbsp;* ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE</span><br />
<span class="S3">&nbsp;* LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span><br />
<span class="S3">&nbsp;* CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span><br />
<span class="S3">&nbsp;* SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span><br />
<span class="S3">&nbsp;* INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span><br />
<span class="S3">&nbsp;* CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span><br />
<span class="S3">&nbsp;* ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span><br />
<span class="S3">&nbsp;* POSSIBILITY OF SUCH DAMAGE.</span><br />
<span class="S3">&nbsp;*</span><br />
<span class="S3">&nbsp;*****************************************************************************/</span><br />
<br />
<span class="S5">namespace</span><span class="S0"> </span>NAntTasks<span class="S0"> </span><span class="S10">{</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">using</span><span class="S0"> </span>System<span class="S10">;</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">using</span><span class="S0"> </span>ILMerging<span class="S10">;</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">using</span><span class="S0"> </span>NAnt<span class="S10">.</span>Core<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">using</span><span class="S0"> </span>NAnt<span class="S10">.</span>Core<span class="S10">.</span>Attributes<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">using</span><span class="S0"> </span>NAnt<span class="S10">.</span>Core<span class="S10">.</span>Types<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">using</span><span class="S0"> </span>NAnt<span class="S10">.</span>Core<span class="S10">.</span>Util<span class="S10">;</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskName<span class="S10">(</span><span class="S6">"ilmerge"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">class</span><span class="S0"> </span>ILMergeTask<span class="S0"> </span><span class="S10">:</span><span class="S0"> </span>Task<span class="S0"> </span><span class="S10">{</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>m_attributeFile<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>m_closed<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>m_copyAttributes<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>m_debugInfo<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>m_excludeFile<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>m_internalize<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>m_log<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>m_logFile<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>m_outputFile<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>m_snkFile<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span>FileSet<span class="S0"> </span>m_assemblies<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">private</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>m_targetKind<span class="S10">;</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"attributefile"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>AttributeFile<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_attributeFile<span class="S0"> </span><span class="S10">!=</span><span class="S0"> </span><span class="S5">null</span><span class="S0"> </span><span class="S10">?</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Project<span class="S10">.</span>GetFullPath<span class="S10">(</span>m_attributeFile<span class="S10">)</span><span class="S0"> </span><span class="S10">:</span><span class="S0"> </span><span class="S5">null</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_attributeFile<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>StringUtils<span class="S10">.</span>ConvertEmptyToNull<span class="S10">(</span><span class="S5">value</span><span class="S10">);</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"closed"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>BooleanValidator<span class="S10">()]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>Closed<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_closed<span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_closed<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S5">value</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"copyattributes"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>BooleanValidator<span class="S10">()]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>CopyAttributes<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_copyAttributes<span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_copyAttributes<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S5">value</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"debuginfo"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>BooleanValidator<span class="S10">()]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>DebugInfo<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_debugInfo<span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_debugInfo<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S5">value</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"excludefile"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>ExcludeFile<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_excludeFile<span class="S0"> </span><span class="S10">!=</span><span class="S0"> </span><span class="S5">null</span><span class="S0"> </span><span class="S10">?</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Project<span class="S10">.</span>GetFullPath<span class="S10">(</span>m_excludeFile<span class="S10">)</span><span class="S0"> </span><span class="S10">:</span><span class="S0"> </span><span class="S5">null</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_excludeFile<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>StringUtils<span class="S10">.</span>ConvertEmptyToNull<span class="S10">(</span><span class="S5">value</span><span class="S10">);</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"internalize"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>BooleanValidator<span class="S10">()]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>Internalize<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_internalize<span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_internalize<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S5">value</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"log"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>BooleanValidator<span class="S10">()]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>ShouldLog<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_log<span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_log<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S5">value</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"logfile"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>LogFile<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_logFile<span class="S0"> </span><span class="S10">!=</span><span class="S0"> </span><span class="S5">null</span><span class="S0"> </span><span class="S10">?</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Project<span class="S10">.</span>GetFullPath<span class="S10">(</span>m_logFile<span class="S10">)</span><span class="S0"> </span><span class="S10">:</span><span class="S0"> </span><span class="S5">null</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_logFile<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>StringUtils<span class="S10">.</span>ConvertEmptyToNull<span class="S10">(</span><span class="S5">value</span><span class="S10">);</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"outputfile"</span><span class="S10">,</span><span class="S0"> </span>Required<span class="S10">=</span><span class="S5">true</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>StringValidator<span class="S10">(</span>AllowEmpty<span class="S10">=</span><span class="S5">false</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>OutputFile<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_outputFile<span class="S0"> </span><span class="S10">!=</span><span class="S0"> </span><span class="S5">null</span><span class="S0"> </span><span class="S10">?</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Project<span class="S10">.</span>GetFullPath<span class="S10">(</span>m_outputFile<span class="S10">)</span><span class="S0"> </span><span class="S10">:</span><span class="S0"> </span><span class="S5">null</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_outputFile<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>StringUtils<span class="S10">.</span>ConvertEmptyToNull<span class="S10">(</span><span class="S5">value</span><span class="S10">);</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"snkfile"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>SnkFile<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_snkFile<span class="S0"> </span><span class="S10">!=</span><span class="S0"> </span><span class="S5">null</span><span class="S0"> </span><span class="S10">?</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Project<span class="S10">.</span>GetFullPath<span class="S10">(</span>m_snkFile<span class="S10">)</span><span class="S0"> </span><span class="S10">:</span><span class="S0"> </span><span class="S5">null</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_snkFile<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>StringUtils<span class="S10">.</span>ConvertEmptyToNull<span class="S10">(</span><span class="S5">value</span><span class="S10">);</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>BuildElement<span class="S10">(</span><span class="S6">"assemblies"</span><span class="S10">,</span><span class="S0"> </span>Required<span class="S10">=</span><span class="S5">true</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span>FileSet<span class="S0"> </span>InputAssemblies<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_assemblies<span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span>m_assemblies<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S5">value</span><span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>TaskAttribute<span class="S10">(</span><span class="S6">"targetkind"</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">[</span>StringValidator<span class="S10">(</span>AllowEmpty<span class="S10">=</span><span class="S5">false</span><span class="S10">)]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">public</span><span class="S0"> </span><span class="S5">virtual</span><span class="S0"> </span><span class="S5">string</span><span class="S0"> </span>TargetKind<span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">get</span><span class="S0"> </span><span class="S10">{</span><span class="S0"> </span><span class="S5">return</span><span class="S0"> </span>m_targetKind<span class="S10">;</span><span class="S0"> </span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">set</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>m_targetKind<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>StringUtils<span class="S10">.</span>ConvertEmptyToNull<span class="S10">(</span><span class="S5">value</span><span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S10">(</span>m_targetKind<span class="S0"> </span><span class="S10">==</span><span class="S0"> </span><span class="S5">null</span><span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>m_targetKind<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S6">"sameasprimary"</span><span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">protected</span><span class="S0"> </span><span class="S5">override</span><span class="S0"> </span><span class="S5">void</span><span class="S0"> </span>ExecuteTask<span class="S10">()</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>AttributeFile<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_attributeFile<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>Closed<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_closed<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>CopyAttributes<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_copyAttributes<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>DebugInfo<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_debugInfo<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>ExcludeFile<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_excludeFile<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>Internalize<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_internalize<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>LogFile<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_logFile<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>Log<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_log<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>OutputFile<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_outputFile<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>SnkFile<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_snkFile<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">switch</span><span class="S0"> </span><span class="S10">(</span>m_targetKind<span class="S10">.</span>ToLower<span class="S10">())</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">case</span><span class="S0"> </span><span class="S6">"winexe"</span><span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>TargetKind<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>ILMerge<span class="S10">.</span>Kind<span class="S10">.</span>WinExe<span class="S10">;</span><span class="S0"> </span><span class="S5">break</span><span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">case</span><span class="S0"> </span><span class="S6">"exe"</span><span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>TargetKind<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>ILMerge<span class="S10">.</span>Kind<span class="S10">.</span>Exe<span class="S10">;</span><span class="S0"> </span><span class="S5">break</span><span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">case</span><span class="S0"> </span><span class="S6">"dll"</span><span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>TargetKind<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>ILMerge<span class="S10">.</span>Kind<span class="S10">.</span>Dll<span class="S10">;</span><span class="S0"> </span><span class="S5">break</span><span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">case</span><span class="S0"> </span><span class="S6">"sameasprimary"</span><span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>TargetKind<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>ILMerge<span class="S10">.</span>Kind<span class="S10">.</span>SameAsPrimaryAssembly<span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">break</span><span class="S10">;</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">default</span><span class="S0"> </span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">throw</span><span class="S0"> </span><span class="S5">new</span><span class="S0"> </span>BuildException<span class="S10">(</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S6">"TargetKind should be [exe|dll|winexe|sameasprimary]"</span><span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">string</span><span class="S10">[]</span><span class="S0"> </span>assemblies<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S5">new</span><span class="S0"> </span><span class="S5">string</span><span class="S10">[</span>m_assemblies<span class="S10">.</span>FileNames<span class="S10">.</span>Count<span class="S10">];</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">for</span><span class="S0"> </span><span class="S10">(</span><span class="S5">int</span><span class="S0"> </span>i<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S4">0</span><span class="S0"> </span><span class="S10">;</span><span class="S0"> </span>i<span class="S0"> </span><span class="S10">&lt;</span><span class="S0"> </span>assemblies<span class="S10">.</span>Length<span class="S0"> </span><span class="S10">;</span><span class="S0"> </span>i<span class="S10">++)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>assemblies<span class="S10">[</span>i<span class="S10">]</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m_assemblies<span class="S10">.</span>FileNames<span class="S10">[</span>i<span class="S10">];</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>SetInputAssemblies<span class="S10">(</span>assemblies<span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>SetSearchDirectories<span class="S10">(</span><span class="S5">new</span><span class="S0"> </span><span class="S5">string</span><span class="S10">[]</span><span class="S0"> </span><span class="S10">{</span><span class="S6">"."</span><span class="S10">});</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">try</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ILMerge<span class="S10">.</span>Merge<span class="S10">();</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><span class="S0"> </span><span class="S5">catch</span><span class="S0"> </span><span class="S10">(</span>Exception<span class="S0"> </span>e<span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">throw</span><span class="S0"> </span><span class="S5">new</span><span class="S0"> </span>BuildException<span class="S10">(</span><span class="S6">"Failed to merge assemblies"</span><span class="S10">,</span><span class="S0"> </span>e<span class="S10">);</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S10">}</span><br />
<span class="S10">}</span></span>
</body>
</html>
